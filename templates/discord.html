{#- The CSS styling rules for the whole page. This is removed
    by `css_inline`. All the CSS here will end up as inline
    `style` attributes. -#}
<style>
   #post-wrapper {
      /* The actual font Discord uses is Uni Sans Heavy, but
         most people probably don't have that font installed.
         Hence we use some fallback fonts that look sort of like it. */
      font-family: Uni Sans Heavy, Verdana, Helvetica, Arial, sans-serif;
      /* #36393E is the dark mode background color. 
         TODO: Add light mode background color. */
      background-color: #36393E;
      min-height: 128px;
      padding: 16px;
      line-height: 1.375rem;
      margin: -16px -12px;
      color: #DCDDDE;
      font-size: 1rem;
   }

   .post-block {
      padding-bottom: 8px;
      display: flex;
      flex-direction: row;
      gap: 16px;
   }

   .message-wrapper {
      overflow-x: hidden;
   }

   .avatar {
      /* The actual background image is set on the avatar div itself */
      background-repeat: no-repeat;
      background-size: contain;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      /* no sizeplay allowed -- avoids the avatars from
         shrinking due to very long messages. */
      flex-shrink: 0; 
   }

   .headline {
      /*  */
      white-space: nowrap;
   }

   .timestamp {
      color: #A3A6AA;
      font-size: 0.75rem;
      padding-left: 10px;
   }

   .message-content {
      word-wrap: break-word;
      margin: 4px 0 8px 0;
   }
</style>

{#- The div for the background and global font styling. -#}
<div id="post-wrapper">

{#- Begin the list of posts. -#}
{%- for post in posts -%}

{#- This first div ensures correct spacing and also ensures
   the avatar appears next to the postblock body. -#}
<div class="post-block" >

{#- The profile picture for the post. The user avatar URL can 
   point to local files, but this will break when uploading to
   Cohost.-#}
<div class="avatar"
     style="{% if post.user.avatar %}
               background-image: url({{ post.user.avatar | safe }});
            {% elif post.user.color %}
               background: {{ post.user.color }};
            {% else %}
               background: #43b581;
            {% endif %}"></div>

{#- We use white-space: nowrap is used to ensures that the timestamp
   doesn't wrap to the next line. and we use overflow-x: hidden to
   clip the timestamp when it would go off-screen.-#}
<div class="message-wrapper">
{#- Post headline. This is the username + timestamp. -#}
<div class="headline">
<span style="color: {{ post.user.color | default(value="white") }}; font-size: 100%;">{{ post.user.name }}</span>
<span class="timestamp">{{ post.timestamp | default (value = "") }}</span>
</div>

{#- Message contents (multiple messages are collapsed into 
   a single post body) -#}
{%- for message in post.messages %}
<p class="message-content">
{#- "safe" keyword is required here, because messages will
   sometimes contain newlines, which we add <br>s to. 
   By default, Tera will escape these tags into literal 
   text, but we don't want this (we want actual html tags
   for the newline), so we need to tell Tera that this is
   safe to not escape (even though, technically, it is not.
   This also means that messages that contain literal text
   of HTML tags will end up rendered as actual HTML tags.
   If you want to type HTML tags (that aren't inside code
   blocks), you can escape it with &lt;. -#}
{{- message | markdown | trim | safe -}}
</p>

{%- endfor -%} {#- end message contents for -#}
</div>         {#- end message-wrapper div -#}
</div>         {#- end post-block div i-#}
{%- endfor -%} {#- end postblock for -#}
</div>         {#- end post-wrapper div -#}